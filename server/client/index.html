<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
        crossorigin="anonymous">
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
      <span class="navbar-brand">Snapmaker Z-Probe Console</span>
    </nav>
    <div class="container-fluid">
      <div class="row step-row" id="step-1">
        <div class="col-8 text-col">
          Step 1: Attach your milling material and move your spindle with bit
          to the desired origin.
        </div>
        <button type="button" class="btn btn-primary col btn-col" id="step-1-ok">Done</button>
      </div>
      <div class="row step-row hidden" id="step-2">
        <div class="col-8 text-col">
          Step 2: Plug in Z-Probe to the Snapmaker USB B port, attach aligator
          clips to spindle bit and milling material.
          
        </div>
        <button type="button" class="btn btn-primary col btn-col" id="step-2-ok">Done</button>
      </div>
      <div class="row step-row hidden" id="step-3">
        <div class="col-8 text-col">Step 3: Connect to the Z-Probe:
          <span id="ble-connected-text" class="hidden">Connected</span>
          <span id="ble-disconnected-text">Disconnected</span>
        </div>
        <button type="button" class="col btn-col btn btn-primary" id="ble-connect">Connect to Bluetooth</button>
        <button type="button" class="col btn-col btn btn-danger hidden" id="ble-disconnect">Disconnect</button>
      </div>
      <div class="row step-row hidden" id="step-4">
        <div class="col-8 text-col">Step 4: Check that Z-Probe is online:
          <span id="ble-ok-text" class="hidden">OK</span>
        </div>
        <button type="button" class="col btn-col btn btn-primary" id="ble-ping">Check</button>
      </div>
      <div class="row step-row hidden" id="step-5">
        <div class="col-8 text-col">Step 5: Upload your gcode</div>
        <label class="col btn-col btn btn-primary">Upload <input type="file" class="hidden" id="upload"></label>
      </div>
      <div class="row step-row hidden" id="step-6">
        <div class="col-8 text-col">
          Step 6: Verify probing points: <span id="time-estimate"></span>
          <br>
          <canvas width="640" height="480" id="probe-points"></canvas>
        </div>
        <button type="button" class="col btn-col btn btn-primary" id="confirm">Confirm</button>
      </div>
      <div class="row step-row hidden" id="step-7">
        <div class="col-8 text-col">Step 7: Initialize Snapmaker</div>
        <button type="button" class="col btn-col btn btn-primary" id="ble-init">Initialize</button>
      </div>
      <div class="row step-row hidden" id="step-8">
        <div class="col-8 text-col">Step 8: Start probing points
          <div class="progress">
            <div class="progress-bar"
              role="progressbar"
              style="width: 0%"
              aria-valuenow="25"
              aria-valuemin="0"
              aria-valuemax="100"
              id="progress">
            </div>
          </div>
        </div>
        <button type="button" class="col btn-col btn btn-primary" id="ble-probe">Begin</button>
      </div>
      <div class="row step-row hidden" id="step-9">
        <div class="col-8 text-col">Step 9: Finish procedure</div>
        <button type="button" class="col btn-col btn btn-primary" id="ble-end">Finish</button>
      </div>
      <div class="row step-row hidden" id="step-10">
        <div class="col-8 text-col">Step 10: Download modified gcode</div>
        <button type="button" class="col btn-col btn btn-primary" id="download">Download</button>
        <form action="/modifyGcode" method="POST" class="hidden" id="download-form">
          <input type="hidden" name="gcode" id="download-gcode"/>
          <input type="hidden" name="depthMap" id="download-depthMap"/>
        </form>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
    <script src="script.js"></script>
  </body>
</html>
